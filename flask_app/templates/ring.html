{% extends "base.html" %}
{% block title %}Anillo de Energía{% endblock %}

{% block content %}
<div id="ringStage" class="ring-stage">
  <!-- Status Bar -->
  <div id="ringStatus" class="ring-status">
    <div class="status-indicator">
      <span id="statusDot" class="status-dot"></span>
      <span id="statusText" class="status-text">Desconectado</span>
    </div>
    <div id="errorMessage" class="error-message"></div>
  </div>

  <!-- Main Canvas Area -->
  <div class="ring-canvas-container">
    <canvas id="ringCanvas"></canvas>
    
    <!-- Center Info Display -->
    <div id="ringInfo" class="ring-info">
      <div id="ringHint" class="ring-hint">
        <svg class="hint-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M12 16v-4M12 8h.01"></path>
        </svg>
        <p class="hint-title">Anillo de Energía de Voz</p>
        <p class="hint-description">Haz clic en cualquier lugar para iniciar la conversación de voz</p>
        <p class="hint-keys">Presiona <kbd>ESC</kbd> para desconectar</p>
      </div>
      
      <div id="loadingIndicator" class="loading-indicator" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Conectando...</p>
      </div>
      
      <div id="activeInfo" class="active-info" style="display: none;">
        <div class="info-item">
          <svg class="info-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" y1="19" x2="12" y2="23"></line>
            <line x1="8" y1="23" x2="16" y2="23"></line>
          </svg>
          <span id="micStatus">Escuchando...</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Control Bar -->
  <div id="controlBar" class="control-bar" style="display: none;">
    <button id="muteBtn" class="control-btn" title="Silenciar micrófono (M)" aria-label="Silenciar micrófono">
      <svg class="btn-icon" id="micIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
        <line x1="12" y1="19" x2="12" y2="23"></line>
        <line x1="8" y1="23" x2="16" y2="23"></line>
      </svg>
      <svg class="btn-icon" id="micOffIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
        <line x1="1" y1="1" x2="23" y2="23"></line>
        <path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"></path>
        <path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"></path>
        <line x1="12" y1="19" x2="12" y2="23"></line>
        <line x1="8" y1="23" x2="16" y2="23"></line>
      </svg>
    </button>
    
    <button id="disconnectBtn" class="control-btn disconnect-btn" title="Desconectar (ESC)" aria-label="Desconectar">
      <svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
      <span>Desconectar</span>
    </button>
  </div>

  <audio id="ringRemoteAudio" autoplay></audio>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/tools-handler.js') }}"></script>
<script src="{{ url_for('static', filename='js/ring.js') }}"></script>
{% endblock %}
